---
title: "Untitled"
author: "Emily Markowitz"
date: "12/22/2020"
output: pdf_document
---

```{r setup, include=FALSE, error=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(ggplot2)
library(showtext)
library(magrittr)
library(tidyverse)
```

# Homework

[Talk about homework]


## Example: The Pythagorean Theorem

$$a^{2} + b^{2} = c^{2}$$

Where: 

 - $a$ is the length of leg A
 - $b$ is leg length of leg B
 - $c$ is the length of leg C, otherwise known as the hypotenuse


```{r}
col_col <- c("#000000",'#000000')
col_fill <- c("#5cb85c","#f9f9f9")
d <- data.frame(x=c(1,5,5), 
             y=c(1,1,3), 
             t=c('a', 'a', 'a'), 
             x.r = c(3, 5.1, 3), 
             y.r = c(0.9, 2, 2.1),
             r=c('A','B','C'))
p <- ggplot(data = d, 
            aes(x = x, 
                y = y, 
                col = factor(t), 
                fill = factor(t))) + 
  geom_polygon(data = d, alpha = .75) + 
       scale_color_manual(values = col_col) + 
  scale_fill_manual(values = col_fill) 
p <- p + geom_point(data = d[1:3,]) + 
  geom_text(data = d, 
            aes(x=x.r, 
                y=y.r, 
                label=r),
            size=6) +
    theme(axis.title.x = element_blank(),
          # axis.text.x  = element_blank(),
          axis.ticks.x = element_blank(),
          # axis.title.y = element_blank(),
          # axis.text.y  = element_blank(),
          axis.ticks.y = element_blank(),
          legend.position = 'none')

p
```


If $a$ = 5 and $b$ = 3, solve for $c$: 

```{r}
pythagoreanTheorem <- function(a1, b1) {
  
  c2 <- a1^2 + b1^2
  
  c0 <- c2^(1/2) # could also use sqrt()
  
  return(c0)
}

pythagoreanTheorem(a1 = 5, b1 = 3)

```


## 1. Newton's Universal Law of Gravitation

```{r, echo = FALSE}
url <- "https://sites.google.com/site/oakastroflash/_/rsrc/1238267876560/Home/laws-of-physics/newton-s-universal-law-of-gravity/04_16Figure-Unanno.jpg?height=254&width=420"
```

$$F = G \frac{m_1 m_2}{d^2}$$

Where: 

 - $F$	=	force
 - $G$	=	gravitational constant ($6.67430*10^{-11}$)
 - $m_1$	=	mass of object 1
 - $m_2$	=	mass of object 2
 - $r$	=	distance between centers of the masses

![Newton's Universal Law of Gravitation](`r "https://sites.google.com/site/oakastroflash/_/rsrc/1238267876560/Home/laws-of-physics/newton-s-universal-law-of-gravity/04_16Figure-Unanno.jpg?height=254&width=420" `)

Solve for F:

> Hint! The Gravitational Constant Shouldn't change, unless you are testing this out on other planets. To save time, add the gravitational constant to where you call your arguments in your function. 

```{r}
NewtonGrav <- function(G0 = 6.67430*10^-11, 
                       m_1, 
                       m_2, 
                       d2){
  
  F1 = G0 * (m_1*m_2)/d2
  
  return(F1)
}
```


## 2. Area Swept (from our surveys!)

```{r}
col_col <- c("#000000",'#000000')
col_fill <- c("#5cb85c","#f9f9f9")
d <- data.frame(x=c(0,0,10,10), 
             y=c(0,0.001,0.001,0), 
             t=c('a', 'a', 'a', 'a'), 
             x.r = c(5, 10.4, 5, 0.5), 
             y.r = c(.0005, .0005, -0.0001, 0.0011),
             r=c('A','D','W', "[boat haul end]"))
p <- ggplot(data = d, 
            aes(x = x, 
                y = y, 
                col = factor(t), 
                fill = factor(t))) + 
  geom_polygon(data = d, alpha = .75) + 
       scale_color_manual(values = col_col) + 
  scale_fill_manual(values = col_fill) 
p <- p + geom_point(data = d[1:3,]) + 
  geom_text(data = d, 
            aes(x=x.r, 
                y=y.r, 
                label=r),
            size=6) +
    theme(axis.title.x = element_blank(),
          # axis.text.x  = element_blank(),
          axis.ticks.x = element_blank(),
          # axis.title.y = element_blank(),
          # axis.text.y  = element_blank(),
          axis.ticks.y = element_blank(),
          legend.position = 'none') +
  geom_segment(aes(x = -0.5, y = 0, 
                   xend = -0.5, yend = 0.001),
                  arrow = arrow(length = unit(1, "cm")))

p
```

This is the area sampled for each observation when we survey. Often we can assume this number is low (e.g., 0.001). In our case, we need to add some conversions to make this useful to the survey outputs. Here I'll write without variables to make it easier to read:

$$Area Swept (km^2) = Distance Fished (hectare) * (Net Width (m) * 0.001 (\frac{km}{m}) ) * 100 (\frac{km}{hectare})$$

But for writing our function, we'll simplify to the core of this equation:

$$area = distance * width$$

Write a function for this equation and solve for $Area Swept (km^2)$. Use a0 = Area, d0 = Distance (.001), w0 = Width (10). 

```{r, echo = FALSE}
AreaSwept<-function(d0, w0) {
  a0<-d0*(w0*0.001)*100
  return(a0)
}

AreaSwept(d0 = .001, w0 = 10)
```

## 3. Catch Per Unit Effort (CPUE)

CPUE is calculated by dividing the catch of each fishing trip by the number of hours fished during that trip. This gives CPUE in units of kilograms per hour.

Here we will combine two datasets, *haul* and *catch*. 

*catch*
```{r}
catch<-data.frame(ID = c(1,1,1,2,2,2), 
              SPP = c("P. Cod", "P. Cod", "P. Cod", "P. Cod", "P. Cod", "P. Cod"), 
              NUM = c(rnorm(n = 6, mean = 5, sd = 10)), 
              WEIGHT = c(rnorm(n = 6, mean = 25, sd = 10)))

kable(catch)


tibble::tribble(
      ~Year.Annual_Landings_kg,
    "<int>              <dbl>",
  "1  2003          310.40914",
  "2  2004          565.30807",
  "3  2005          163.24191",
  "4  2006           37.11914",
  "5  2010          131.84178",
  "6  2011          156.77825",
  "7  2012          101.53198",
  "8  2013          579.52008",
  "9  2014         1193.75519"
  )


```

*haul*
```{r}
haul<-data.frame(ID = c(1,2), 
              VESSEL = c("F/V 1", "F/V 2"), 
              NUM = c(rnorm(n = 6, mean = 5, sd = 10)), 
              WEIGHT = c(rnorm(n = 6, mean = 25, sd = 10)))

kable(haul)
```


Here, combine these two dataframes (hint: use dplyr::left_join()) and calculate CPUE 

```{r}

CPUE <- function(){
  CPUE<-dplyr::left_join(catch, haul, by = ID)
}

```
